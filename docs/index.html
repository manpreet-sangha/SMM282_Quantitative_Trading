<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Limit Order Book Simulator | SMM282 Quantitative Trading</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Limit Order Book Simulator</h1>
            <p class="subtitle">SMM282 Quantitative Trading - Price-Visibility-Time Priority</p>
        </header>

        <div class="info-panel">
            <h3>üìö Matching Priority Rules</h3>
            <div class="rules">
                <div class="rule">
                    <span class="rule-num">1</span>
                    <div>
                        <strong>Price First</strong>
                        <p>Buy orders with higher limit prices get priority. Sell orders with lower limit prices get priority.</p>
                    </div>
                </div>
                <div class="rule">
                    <span class="rule-num">2</span>
                    <div>
                        <strong>Visibility</strong>
                        <p>Visible orders get priority over hidden orders at the same price level.</p>
                    </div>
                </div>
                <div class="rule">
                    <span class="rule-num">3</span>
                    <div>
                        <strong>Time (FIFO)</strong>
                        <p>Earlier submitted orders get priority at the same price and visibility.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- Mode Selection -->
            <div class="mode-selection" id="modeSelection">
                <h2>Choose Demo Mode</h2>
                <div class="mode-buttons">
                    <button class="btn btn-mode" onclick="selectMode('sample')">
                        <span class="mode-icon">üìã</span>
                        <span class="mode-title">Load Sample Orders</span>
                        <span class="mode-desc">Pre-loaded orders from lecture example sorted by arrival time</span>
                    </button>
                    <button class="btn btn-mode" onclick="selectMode('custom')" disabled>
                        <span class="mode-icon">‚úèÔ∏è</span>
                        <span class="mode-title">Custom Order Book</span>
                        <span class="mode-desc">Create your own orders (Coming Soon)</span>
                    </button>
                </div>
            </div>

            <!-- Sample Orders Demo Section -->
            <div class="demo-panel" id="sampleDemo" style="display: none;">
                <div class="demo-header-bar">
                    <h2>üìã Limit Order Processing - Sequence of Buy Orders Example</h2>
                    <button class="btn btn-secondary btn-small" onclick="backToModeSelection()">‚Üê Back</button>
                </div>

                <div class="demo-controls">
                    <button class="btn btn-primary btn-large" onclick="processLimitOrderBook()" id="processBtn">
                        ‚ñ∂ Process Limit Order Book
                    </button>
                    <button class="btn btn-secondary" onclick="resetDemo()">‚Ü∫ Reset to Step 1</button>
                </div>

                <div class="step-indicator">
                    <div class="step" id="step1"><span>1</span> Arrival Time</div>
                    <div class="step" id="step2"><span>2</span> Price</div>
                    <div class="step" id="step3"><span>3</span> Visibility</div>
                    <div class="step" id="step4"><span>4</span> Time (FIFO)</div>
                </div>

                <div class="demo-section">
                    <h2 id="stepTitle">(1) Orders by Arrival Time</h2>
                    <p id="stepDescription" class="step-description">Orders displayed in the sequence they arrived at the exchange.</p>
                    
                    <div class="demo-order-table">
                        <div class="demo-table-header">
                            <span>Limit Price</span>
                            <span>Visibility</span>
                            <span>Time</span>
                            <span>Trader Number</span>
                        </div>
                        <div id="demoOrdersContainer" class="demo-orders"></div>
                    </div>
                </div>
            </div>

            <!-- Custom Order Book Section (Future) -->
            <div class="custom-panel" id="customDemo" style="display: none;">
                <div class="demo-header-bar">
                    <h2>‚úèÔ∏è Custom Order Book</h2>
                    <button class="btn btn-secondary btn-small" onclick="backToModeSelection()">‚Üê Back</button>
                </div>
                <p>Custom order book feature coming soon...</p>
            </div>
        </div>

        <!-- Hidden sections for future use -->
        <div class="bottom-section" id="bottomSection" style="display: none;">
            <div class="trades-section">
                <h2>üí± Trade History</h2>
                <div class="trades-table">
                    <div class="trades-header">
                        <span>Trade ID</span>
                        <span>Buy Order</span>
                        <span>Sell Order</span>
                        <span>Price</span>
                        <span>Quantity</span>
                        <span>Time</span>
                    </div>
                    <div id="tradesContainer" class="trades-rows"></div>
                </div>
            </div>

            <div class="orders-section">
                <h2>üìã All Orders</h2>
                <div class="orders-table">
                    <div class="orders-header">
                        <span>ID</span>
                        <span>Side</span>
                        <span>Price</span>
                        <span>Qty</span>
                        <span>Filled</span>
                        <span>Visible</span>
                        <span>Status</span>
                        <span>Action</span>
                    </div>
                    <div id="ordersContainer" class="orders-rows"></div>
                </div>
            </div>
        </div>

        <div class="visualization-section" id="vizSection" style="display: none;">
            <h2>üìä Depth Chart</h2>
            <canvas id="depthChart"></canvas>
        </div>

        <!-- Hidden form for order book functionality -->
        <form id="orderForm" style="display: none;">
            <input type="text" id="orderId">
            <select id="side"><option value="BUY">BUY</option></select>
            <input type="number" id="price" value="100">
            <input type="number" id="quantity" value="100">
            <input type="checkbox" id="isVisible" checked>
        </form>
        <div style="display: none;">
            <span id="bestBid"></span>
            <span id="bestAsk"></span>
            <span id="spread"></span>
            <span id="midpoint"></span>
            <div id="asksContainer"></div>
            <div id="bidsContainer"></div>
        </div>

        <footer>
            <p>SMM282 Quantitative Trading | City St George's, University of London</p>
            <p><a href="https://github.com/manpreet-sangha/SMM282_Quantitative_Trading" target="_blank">View on GitHub</a></p>
        </footer>
    </div>

    <script src="js/order-book.js"></script>
    <script src="js/visualization.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
